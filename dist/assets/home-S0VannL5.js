import{_ as B,u as S,r,o as V,c as i,a as h,b as n,F as f,d as E,e as a,n as L,t as _,s as N}from"./index-n9atX4sB.js";import{c as x}from"./contentfulClient-cIsO_rlL.js";import{b as C}from"./banner-B5g24Tdb.js";const H={class:"container"},I={class:"articles"},M=["onClick"],U={id:"title"},$={id:"date"},q=["innerHTML"],v=6,F={__name:"home",setup(R){const y=S(),c=r([]),d=r(0),u=r(!1),b=t=>{y.add({severity:"error",summary:"An error occured",detail:t,life:2e3})},g=t=>{window.location.href=`/article/${t}`},w=(t,o)=>{const s=t.fields;for(var e={id:t.sys.id,thumbnailUrl:"",title:s.entryName,body:"",date:t.sys.updatedAt.split("T")[0]},l=0;l<s.article.content.length;l++){const p=s.article.content[l];p.nodeType==="paragraph"&&(e.body+=`<p>${p.content[0].value}</p>`);try{e.thumbnailUrl=o[s.thumbnail.sys.id].url}catch{console.log("No thumbnail found")}}c.value.push(e)},T=t=>{for(var o={},s=0;s<t.Asset.length;s++){const e=t.Asset[s];o[e.sys.id]={url:e.fields.file.url,contentType:e.fields.file.contentType}}return o},m=()=>{u.value||x.getEntries({limit:v,skip:d.value}).then(t=>{if(t.total==0){u.value=!0;return}const o=T(t.includes);for(var s=0;s<t.items.length;s++){const e=t.items[s];w(e,o)}d.value+=v}).catch(t=>{console.error(t),b(t)})},A=t=>{let o=t.getBoundingClientRect(),s=o.top,e=o.bottom;return s<window.innerHeight&&e>=0},k=()=>{window.onscroll=t=>{let o=document.querySelector(".end");o&&A(o)&&m()}};return V(()=>{m(),window.addEventListener("scroll",()=>{k()})}),(t,o)=>{const s=N;return a(),i(f,null,[h(s),h(C),n("div",H,[n("div",I,[(a(!0),i(f,null,E(c.value,e=>(a(),i("div",{key:e.title,class:"article",onClick:l=>g(e.id)},[n("div",{id:"thumbnail",style:L({backgroundImage:"url("+e.thumbnailUrl+")"}),alt:"thumbnail"},null,4),n("h1",U,_(e.title),1),n("p",$,_(e.date),1),n("div",{id:"body",innerHTML:e.body},null,8,q)],8,M))),128))])]),o[0]||(o[0]=n("div",{class:"end"},null,-1))],64)}}},K=B(F,[["__scopeId","data-v-2c55bf1c"]]);export{K as default};
